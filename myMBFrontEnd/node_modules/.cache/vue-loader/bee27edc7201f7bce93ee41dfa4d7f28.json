{"remainingRequest":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/Item.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/Item.vue","mtime":1583676124000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGRlbENvbW1lbnRTZXJ2aWNlLCB1cGRhdGVDb21tZW50U2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2NvbW1lbnQnCmltcG9ydCB7IGZvcm1hdER0IH0gZnJvbSAnLi4vLi4vdXRpbHMvZHQnCmltcG9ydCBldmVudCBmcm9tICcuLi8uLi91dGlscy9ldmVudCcKCmV4cG9ydCBkZWZhdWx0IHsKICAgIHByb3BzOiBbJ2RhdGEnXSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY2lyY2xlVXJsOiAiaHR0cHM6Ly9jdWJlLmVsZW1lY2RuLmNvbS8zLzdjLzNlYTZiZWVjNjQzNjljMjY0MmI5MmM2NzI2ZjFlcG5nLnBuZyIsCiAgICAgICAgICAgIHNob3dFZGl0TW9kYWw6IGZhbHNlLAogICAgICAgICAgICBuZXdDb250ZW50OiAnJwogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIF9pZCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5faWQKICAgICAgICB9LAogICAgICAgIGNyZWF0ZWRBdCgpIHsKICAgICAgICAgICAgcmV0dXJuIGZvcm1hdER0KHRoaXMuZGF0YS5jcmVhdGVkQXQpCiAgICAgICAgfSwKICAgICAgICBpc015KCkgewogICAgICAgICAgICAvLyDov5nmnaHnlZnoqIDvvIzmmK/kuI3mmK/miJHoh6rlt7Hlj5HnmoTvvJ8KICAgICAgICAgICAgY29uc3QgY3VyRGF0YSA9IHRoaXMuZGF0YQogICAgICAgICAgICBpZiAoIWN1ckRhdGEpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBjdXJEYXRhLnVzZXJuYW1lID09PSB3aW5kb3cudXNlckluZm8udXNlcm5hbWUKICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGFzeW5jIHVwZGF0ZSgpIHsKICAgICAgICAgICAgLy8g5YWz6Zet5by55qGGCiAgICAgICAgICAgIHRoaXMuc2hvd0VkaXRNb2RhbCA9IGZhbHNlCgogICAgICAgICAgICAvLyDmm7TmlrDmlbDmja4KICAgICAgICAgICAgY29uc3QgbmV3RGF0YSA9IGF3YWl0IHVwZGF0ZUNvbW1lbnRTZXJ2aWNlKHRoaXMuX2lkLCB0aGlzLm5ld0NvbnRlbnQpCiAgICAgICAgICAgIGV2ZW50LiRlbWl0KCdvbkNvbW1lbnRVcGRhdGUnLCBuZXdEYXRhKQoKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKCfkv67mlLnmiJDlip8nKQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZGVsKCkgewogICAgICAgICAgICBpZiAod2luZG93LmNvbmZpcm0oJ+ehruWumuWIoOmZpO+8nycpKSB7CiAgICAgICAgICAgICAgICBhd2FpdCBkZWxDb21tZW50U2VydmljZSh0aGlzLl9pZCkKICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLm5ld0NvbnRlbnQgPSB0aGlzLmRhdGEuY29udGVudAogICAgfQp9Cg=="},{"version":3,"sources":["Item.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Item.vue","sourceRoot":"src/pages/Comment","sourcesContent":["<template>\n    <div>\n        <el-divider></el-divider>\n        <div class=\"userinfo\">\n            <el-avatar :size=\"30\" :src=\"circleUrl\"></el-avatar>\n            <span class=\"username\">{{data.username}}</span>\n            <span class=\"time\">{{createdAt}}</span>\n        </div>\n        <p>{{data.content}}</p>\n        <div v-if=\"isMy\">\n            <el-button type=\"text\" @click=\"showEditModal = true\">编辑</el-button>\n            <el-button type=\"text\" style=\"color: red;\" @click=\"del\">删除</el-button>\n        </div>\n\n        <!-- 编辑留言 -->\n        <el-dialog\n            title=\"编辑留言\"\n            :visible.sync=\"showEditModal\"\n            width=\"50%\">\n            <el-input\n                type=\"textarea\"\n                :rows=\"3\"\n                v-model=\"newContent\">\n            </el-input>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"showEditModal = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"update\">确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport { delCommentService, updateCommentService } from '../../services/comment'\nimport { formatDt } from '../../utils/dt'\nimport event from '../../utils/event'\n\nexport default {\n    props: ['data'],\n    data() {\n        return {\n            circleUrl: \"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\",\n            showEditModal: false,\n            newContent: ''\n        }\n    },\n    computed: {\n        _id() {\n            return this.data._id\n        },\n        createdAt() {\n            return formatDt(this.data.createdAt)\n        },\n        isMy() {\n            // 这条留言，是不是我自己发的？\n            const curData = this.data\n            if (!curData) {\n                return false\n            }\n            return curData.username === window.userInfo.username\n        }\n    },\n    methods: {\n        async update() {\n            // 关闭弹框\n            this.showEditModal = false\n\n            // 更新数据\n            const newData = await updateCommentService(this._id, this.newContent)\n            event.$emit('onCommentUpdate', newData)\n\n            this.$message.info('修改成功')\n        },\n        async del() {\n            if (window.confirm('确定删除？')) {\n                await delCommentService(this._id)\n                location.reload()\n            }\n        }\n    },\n    mounted() {\n        this.newContent = this.data.content\n    }\n}\n</script>\n\n<style lang=\"css\" scoped>\n.userinfo {\n    position: relative;\n}\n.username {\n    position: absolute;\n    margin-left: 5px;\n    margin-top: 7px;\n}\n.time {\n    font-size: 12px;\n    color: #666;\n    position: absolute;\n    right: 0;\n}\n</style>"]}]}