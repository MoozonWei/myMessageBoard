{"remainingRequest":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/index.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/index.vue","mtime":1583675320000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouY29udGFpbmVyIHsKICAgIG1hcmdpbjogMjBweCA1MHB4IDA7Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/Comment","sourcesContent":["<template>\n    <div class=\"container\">\n        <Input @addComment=\"addComment\"/>\n        <div style=\"margin-top: 20px;\">\n            <el-radio v-model=\"filterType\" :label=\"1\">看全部</el-radio>\n            <el-radio v-model=\"filterType\" :label=\"2\">只看自己</el-radio>\n        </div>\n        <List :list=\"list\"/>\n    </div>\n</template>\n\n<script>\nimport { createCommentService, getCommentListService } from '../../services/comment'\nimport Input from './Input'\nimport List from './List'\nimport event from '../../utils/event'\n\nexport default {\n    components: {\n        Input,\n        List\n    },\n    data() {\n        return {\n            filterType: 1, // 1 - 看全部；2 - 只看自己\n            list: [\n                // // 模拟数据\n                // {\n                //     _id: 1,\n                //     username: 'zhangsan',\n                //     content: '留言内容A 留言内容A 留言内容A 留言内容A 留言内容A ',\n                //     createdAt: Date.now()\n                // },\n                // {\n                //     _id: 2,\n                //     username: 'lisi',\n                //     content: '留言内容B 留言内容B 留言内容B 留言内容B 留言内容B ',\n                //     createdAt: Date.now() - 5 * 60 * 1000 // 5 分钟以前\n                // },\n                // {\n                //     _id: 3,\n                //     username: 'wangwu',\n                //     content: '留言内容C 留言内容C 留言内容C 留言内容C 留言内容C ',\n                //     createdAt: Date.now() - 10 * 60 * 1000 // 10 分钟以前\n                // },\n            ]\n        }\n    },\n    watch: {\n        filterType() {\n            this.getCommentList()\n        }\n    },\n    methods: {\n        async getCommentList() {\n            // 获取列表\n            const commentList = await getCommentListService(this.filterType)\n            this.list = commentList\n        },\n        async addComment(content) {\n            // const data = {\n            //     id: this.list.length + 1,\n            //     username: 'zhangsan',\n            //     content,\n            //     createdAt: Date.now()\n            // }\n\n            const data = await createCommentService(content)\n\n            this.list.unshift(data)\n        },\n        updateHandler(newComment) {\n            this.list = this.list.map(item => {\n                console.log(item._id, newComment._id)\n                if (item._id === newComment._id) {\n                    console.log('newComment', newComment)\n                    return newComment\n                }\n                return item\n            })\n        },\n    },\n    async mounted() {\n        this.getCommentList()\n\n        // 更新数据时，监听\n        event.$on('onCommentUpdate', this.updateHandler)\n    },\n    beforeDestroy() {\n        event.$off('onCommentUpdate', this.updateHandler)\n    }\n}\n</script>\n\n<style>\n.container {\n    margin: 20px 50px 0;\n}\n</style>"]}]}