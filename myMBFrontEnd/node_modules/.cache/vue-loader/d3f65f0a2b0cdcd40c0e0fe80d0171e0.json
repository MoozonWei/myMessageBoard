{"remainingRequest":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/index.vue","mtime":1583675320000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNyZWF0ZUNvbW1lbnRTZXJ2aWNlLCBnZXRDb21tZW50TGlzdFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jb21tZW50JwppbXBvcnQgSW5wdXQgZnJvbSAnLi9JbnB1dCcKaW1wb3J0IExpc3QgZnJvbSAnLi9MaXN0JwppbXBvcnQgZXZlbnQgZnJvbSAnLi4vLi4vdXRpbHMvZXZlbnQnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgSW5wdXQsCiAgICAgICAgTGlzdAogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZmlsdGVyVHlwZTogMSwgLy8gMSAtIOeci+WFqOmDqO+8mzIgLSDlj6rnnIvoh6rlt7EKICAgICAgICAgICAgbGlzdDogWwogICAgICAgICAgICAgICAgLy8gLy8g5qih5ouf5pWw5o2uCiAgICAgICAgICAgICAgICAvLyB7CiAgICAgICAgICAgICAgICAvLyAgICAgX2lkOiAxLAogICAgICAgICAgICAgICAgLy8gICAgIHVzZXJuYW1lOiAnemhhbmdzYW4nLAogICAgICAgICAgICAgICAgLy8gICAgIGNvbnRlbnQ6ICfnlZnoqIDlhoXlrrlBIOeVmeiogOWGheWuuUEg55WZ6KiA5YaF5a65QSDnlZnoqIDlhoXlrrlBIOeVmeiogOWGheWuuUEgJywKICAgICAgICAgICAgICAgIC8vICAgICBjcmVhdGVkQXQ6IERhdGUubm93KCkKICAgICAgICAgICAgICAgIC8vIH0sCiAgICAgICAgICAgICAgICAvLyB7CiAgICAgICAgICAgICAgICAvLyAgICAgX2lkOiAyLAogICAgICAgICAgICAgICAgLy8gICAgIHVzZXJuYW1lOiAnbGlzaScsCiAgICAgICAgICAgICAgICAvLyAgICAgY29udGVudDogJ+eVmeiogOWGheWuuUIg55WZ6KiA5YaF5a65QiDnlZnoqIDlhoXlrrlCIOeVmeiogOWGheWuuUIg55WZ6KiA5YaF5a65QiAnLAogICAgICAgICAgICAgICAgLy8gICAgIGNyZWF0ZWRBdDogRGF0ZS5ub3coKSAtIDUgKiA2MCAqIDEwMDAgLy8gNSDliIbpkp/ku6XliY0KICAgICAgICAgICAgICAgIC8vIH0sCiAgICAgICAgICAgICAgICAvLyB7CiAgICAgICAgICAgICAgICAvLyAgICAgX2lkOiAzLAogICAgICAgICAgICAgICAgLy8gICAgIHVzZXJuYW1lOiAnd2FuZ3d1JywKICAgICAgICAgICAgICAgIC8vICAgICBjb250ZW50OiAn55WZ6KiA5YaF5a65QyDnlZnoqIDlhoXlrrlDIOeVmeiogOWGheWuuUMg55WZ6KiA5YaF5a65QyDnlZnoqIDlhoXlrrlDICcsCiAgICAgICAgICAgICAgICAvLyAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpIC0gMTAgKiA2MCAqIDEwMDAgLy8gMTAg5YiG6ZKf5Lul5YmNCiAgICAgICAgICAgICAgICAvLyB9LAogICAgICAgICAgICBdCiAgICAgICAgfQogICAgfSwKICAgIHdhdGNoOiB7CiAgICAgICAgZmlsdGVyVHlwZSgpIHsKICAgICAgICAgICAgdGhpcy5nZXRDb21tZW50TGlzdCgpCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBhc3luYyBnZXRDb21tZW50TGlzdCgpIHsKICAgICAgICAgICAgLy8g6I635Y+W5YiX6KGoCiAgICAgICAgICAgIGNvbnN0IGNvbW1lbnRMaXN0ID0gYXdhaXQgZ2V0Q29tbWVudExpc3RTZXJ2aWNlKHRoaXMuZmlsdGVyVHlwZSkKICAgICAgICAgICAgdGhpcy5saXN0ID0gY29tbWVudExpc3QKICAgICAgICB9LAogICAgICAgIGFzeW5jIGFkZENvbW1lbnQoY29udGVudCkgewogICAgICAgICAgICAvLyBjb25zdCBkYXRhID0gewogICAgICAgICAgICAvLyAgICAgaWQ6IHRoaXMubGlzdC5sZW5ndGggKyAxLAogICAgICAgICAgICAvLyAgICAgdXNlcm5hbWU6ICd6aGFuZ3NhbicsCiAgICAgICAgICAgIC8vICAgICBjb250ZW50LAogICAgICAgICAgICAvLyAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpCiAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjcmVhdGVDb21tZW50U2VydmljZShjb250ZW50KQoKICAgICAgICAgICAgdGhpcy5saXN0LnVuc2hpZnQoZGF0YSkKICAgICAgICB9LAogICAgICAgIHVwZGF0ZUhhbmRsZXIobmV3Q29tbWVudCkgewogICAgICAgICAgICB0aGlzLmxpc3QgPSB0aGlzLmxpc3QubWFwKGl0ZW0gPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbS5faWQsIG5ld0NvbW1lbnQuX2lkKQogICAgICAgICAgICAgICAgaWYgKGl0ZW0uX2lkID09PSBuZXdDb21tZW50Ll9pZCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCduZXdDb21tZW50JywgbmV3Q29tbWVudCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q29tbWVudAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0KICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgfSwKICAgIGFzeW5jIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5nZXRDb21tZW50TGlzdCgpCgogICAgICAgIC8vIOabtOaWsOaVsOaNruaXtu+8jOebkeWQrAogICAgICAgIGV2ZW50LiRvbignb25Db21tZW50VXBkYXRlJywgdGhpcy51cGRhdGVIYW5kbGVyKQogICAgfSwKICAgIGJlZm9yZURlc3Ryb3koKSB7CiAgICAgICAgZXZlbnQuJG9mZignb25Db21tZW50VXBkYXRlJywgdGhpcy51cGRhdGVIYW5kbGVyKQogICAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;AAYA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/Comment","sourcesContent":["<template>\n    <div class=\"container\">\n        <Input @addComment=\"addComment\"/>\n        <div style=\"margin-top: 20px;\">\n            <el-radio v-model=\"filterType\" :label=\"1\">看全部</el-radio>\n            <el-radio v-model=\"filterType\" :label=\"2\">只看自己</el-radio>\n        </div>\n        <List :list=\"list\"/>\n    </div>\n</template>\n\n<script>\nimport { createCommentService, getCommentListService } from '../../services/comment'\nimport Input from './Input'\nimport List from './List'\nimport event from '../../utils/event'\n\nexport default {\n    components: {\n        Input,\n        List\n    },\n    data() {\n        return {\n            filterType: 1, // 1 - 看全部；2 - 只看自己\n            list: [\n                // // 模拟数据\n                // {\n                //     _id: 1,\n                //     username: 'zhangsan',\n                //     content: '留言内容A 留言内容A 留言内容A 留言内容A 留言内容A ',\n                //     createdAt: Date.now()\n                // },\n                // {\n                //     _id: 2,\n                //     username: 'lisi',\n                //     content: '留言内容B 留言内容B 留言内容B 留言内容B 留言内容B ',\n                //     createdAt: Date.now() - 5 * 60 * 1000 // 5 分钟以前\n                // },\n                // {\n                //     _id: 3,\n                //     username: 'wangwu',\n                //     content: '留言内容C 留言内容C 留言内容C 留言内容C 留言内容C ',\n                //     createdAt: Date.now() - 10 * 60 * 1000 // 10 分钟以前\n                // },\n            ]\n        }\n    },\n    watch: {\n        filterType() {\n            this.getCommentList()\n        }\n    },\n    methods: {\n        async getCommentList() {\n            // 获取列表\n            const commentList = await getCommentListService(this.filterType)\n            this.list = commentList\n        },\n        async addComment(content) {\n            // const data = {\n            //     id: this.list.length + 1,\n            //     username: 'zhangsan',\n            //     content,\n            //     createdAt: Date.now()\n            // }\n\n            const data = await createCommentService(content)\n\n            this.list.unshift(data)\n        },\n        updateHandler(newComment) {\n            this.list = this.list.map(item => {\n                console.log(item._id, newComment._id)\n                if (item._id === newComment._id) {\n                    console.log('newComment', newComment)\n                    return newComment\n                }\n                return item\n            })\n        },\n    },\n    async mounted() {\n        this.getCommentList()\n\n        // 更新数据时，监听\n        event.$on('onCommentUpdate', this.updateHandler)\n    },\n    beforeDestroy() {\n        event.$off('onCommentUpdate', this.updateHandler)\n    }\n}\n</script>\n\n<style>\n.container {\n    margin: 20px 50px 0;\n}\n</style>"]}]}