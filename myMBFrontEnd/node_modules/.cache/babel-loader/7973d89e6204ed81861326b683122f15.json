{"remainingRequest":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/babel-loader/lib/index.js!/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/Item.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/src/pages/Comment/Item.vue","mtime":1583676124000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weizihan/Projects/JavaScriptPractice/myMessageBoard/myMBFrontEnd/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL3dlaXppaGFuL1Byb2plY3RzL0phdmFTY3JpcHRQcmFjdGljZS9teU1lc3NhZ2VCb2FyZC9teU1CRnJvbnRFbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBkZWxDb21tZW50U2VydmljZSwgdXBkYXRlQ29tbWVudFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jb21tZW50JzsKaW1wb3J0IHsgZm9ybWF0RHQgfSBmcm9tICcuLi8uLi91dGlscy9kdCc7CmltcG9ydCBldmVudCBmcm9tICcuLi8uLi91dGlscy9ldmVudCc7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogWydkYXRhJ10sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNpcmNsZVVybDogImh0dHBzOi8vY3ViZS5lbGVtZWNkbi5jb20vMy83Yy8zZWE2YmVlYzY0MzY5YzI2NDJiOTJjNjcyNmYxZXBuZy5wbmciLAogICAgICBzaG93RWRpdE1vZGFsOiBmYWxzZSwKICAgICAgbmV3Q29udGVudDogJycKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgX2lkOiBmdW5jdGlvbiBfaWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRhdGEuX2lkOwogICAgfSwKICAgIGNyZWF0ZWRBdDogZnVuY3Rpb24gY3JlYXRlZEF0KCkgewogICAgICByZXR1cm4gZm9ybWF0RHQodGhpcy5kYXRhLmNyZWF0ZWRBdCk7CiAgICB9LAogICAgaXNNeTogZnVuY3Rpb24gaXNNeSgpIHsKICAgICAgLy8g6L+Z5p2h55WZ6KiA77yM5piv5LiN5piv5oiR6Ieq5bex5Y+R55qE77yfCiAgICAgIHZhciBjdXJEYXRhID0gdGhpcy5kYXRhOwoKICAgICAgaWYgKCFjdXJEYXRhKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gY3VyRGF0YS51c2VybmFtZSA9PT0gd2luZG93LnVzZXJJbmZvLnVzZXJuYW1lOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgbmV3RGF0YTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAvLyDlhbPpl63lvLnmoYYKICAgICAgICAgICAgICAgIF90aGlzLnNob3dFZGl0TW9kYWwgPSBmYWxzZTsgLy8g5pu05paw5pWw5o2uCgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQ29tbWVudFNlcnZpY2UoX3RoaXMuX2lkLCBfdGhpcy5uZXdDb250ZW50KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgbmV3RGF0YSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBldmVudC4kZW1pdCgnb25Db21tZW50VXBkYXRlJywgbmV3RGF0YSk7CgogICAgICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuaW5mbygn5L+u5pS55oiQ5YqfJyk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBkZWw6IGZ1bmN0aW9uIGRlbCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghd2luZG93LmNvbmZpcm0oJ+ehruWumuWIoOmZpO+8nycpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGRlbENvbW1lbnRTZXJ2aWNlKF90aGlzMi5faWQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5uZXdDb250ZW50ID0gdGhpcy5kYXRhLmNvbnRlbnQ7CiAgfQp9Ow=="},{"version":3,"sources":["Item.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,SAAA,iBAAA,EAAA,oBAAA,QAAA,wBAAA;AACA,SAAA,QAAA,QAAA,gBAAA;AACA,OAAA,KAAA,MAAA,mBAAA;AAEA,eAAA;AACA,EAAA,KAAA,EAAA,CAAA,MAAA,CADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,SAAA,EAAA,qEADA;AAEA,MAAA,aAAA,EAAA,KAFA;AAGA,MAAA,UAAA,EAAA;AAHA,KAAA;AAKA,GARA;AASA,EAAA,QAAA,EAAA;AACA,IAAA,GADA,iBACA;AACA,aAAA,KAAA,IAAA,CAAA,GAAA;AACA,KAHA;AAIA,IAAA,SAJA,uBAIA;AACA,aAAA,QAAA,CAAA,KAAA,IAAA,CAAA,SAAA,CAAA;AACA,KANA;AAOA,IAAA,IAPA,kBAOA;AACA;AACA,UAAA,OAAA,GAAA,KAAA,IAAA;;AACA,UAAA,CAAA,OAAA,EAAA;AACA,eAAA,KAAA;AACA;;AACA,aAAA,OAAA,CAAA,QAAA,KAAA,MAAA,CAAA,QAAA,CAAA,QAAA;AACA;AAdA,GATA;AAyBA,EAAA,OAAA,EAAA;AACA,IAAA,MADA,oBACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,gBAAA,KAAA,CAAA,aAAA,GAAA,KAAA,CAFA,CAIA;;AAJA;AAAA,uBAKA,oBAAA,CAAA,KAAA,CAAA,GAAA,EAAA,KAAA,CAAA,UAAA,CALA;;AAAA;AAKA,gBAAA,OALA;AAMA,gBAAA,KAAA,CAAA,KAAA,CAAA,iBAAA,EAAA,OAAA;;AAEA,gBAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CAAA,MAAA;;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA,KAVA;AAWA,IAAA,GAXA,iBAWA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACA,MAAA,CAAA,OAAA,CAAA,OAAA,CADA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAEA,iBAAA,CAAA,MAAA,CAAA,GAAA,CAFA;;AAAA;AAGA,gBAAA,QAAA,CAAA,MAAA;;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAhBA,GAzBA;AA2CA,EAAA,OA3CA,qBA2CA;AACA,SAAA,UAAA,GAAA,KAAA,IAAA,CAAA,OAAA;AACA;AA7CA,CAAA","sourcesContent":["<template>\n    <div>\n        <el-divider></el-divider>\n        <div class=\"userinfo\">\n            <el-avatar :size=\"30\" :src=\"circleUrl\"></el-avatar>\n            <span class=\"username\">{{data.username}}</span>\n            <span class=\"time\">{{createdAt}}</span>\n        </div>\n        <p>{{data.content}}</p>\n        <div v-if=\"isMy\">\n            <el-button type=\"text\" @click=\"showEditModal = true\">编辑</el-button>\n            <el-button type=\"text\" style=\"color: red;\" @click=\"del\">删除</el-button>\n        </div>\n\n        <!-- 编辑留言 -->\n        <el-dialog\n            title=\"编辑留言\"\n            :visible.sync=\"showEditModal\"\n            width=\"50%\">\n            <el-input\n                type=\"textarea\"\n                :rows=\"3\"\n                v-model=\"newContent\">\n            </el-input>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"showEditModal = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"update\">确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport { delCommentService, updateCommentService } from '../../services/comment'\nimport { formatDt } from '../../utils/dt'\nimport event from '../../utils/event'\n\nexport default {\n    props: ['data'],\n    data() {\n        return {\n            circleUrl: \"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\",\n            showEditModal: false,\n            newContent: ''\n        }\n    },\n    computed: {\n        _id() {\n            return this.data._id\n        },\n        createdAt() {\n            return formatDt(this.data.createdAt)\n        },\n        isMy() {\n            // 这条留言，是不是我自己发的？\n            const curData = this.data\n            if (!curData) {\n                return false\n            }\n            return curData.username === window.userInfo.username\n        }\n    },\n    methods: {\n        async update() {\n            // 关闭弹框\n            this.showEditModal = false\n\n            // 更新数据\n            const newData = await updateCommentService(this._id, this.newContent)\n            event.$emit('onCommentUpdate', newData)\n\n            this.$message.info('修改成功')\n        },\n        async del() {\n            if (window.confirm('确定删除？')) {\n                await delCommentService(this._id)\n                location.reload()\n            }\n        }\n    },\n    mounted() {\n        this.newContent = this.data.content\n    }\n}\n</script>\n\n<style lang=\"css\" scoped>\n.userinfo {\n    position: relative;\n}\n.username {\n    position: absolute;\n    margin-left: 5px;\n    margin-top: 7px;\n}\n.time {\n    font-size: 12px;\n    color: #666;\n    position: absolute;\n    right: 0;\n}\n</style>"],"sourceRoot":"src/pages/Comment"}]}